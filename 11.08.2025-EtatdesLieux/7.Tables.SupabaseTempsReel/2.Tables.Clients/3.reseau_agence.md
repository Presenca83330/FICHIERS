# TABLE: reseau_agence

**Date de gÃ©nÃ©ration:** 17.08.2025  
**Statut:** âœ… ACTIVE  
**Type:** Table mÃ©tier - Agences de rÃ©seau

---

## ğŸ“‹ STRUCTURE DE LA TABLE

| Colonne | Type | Nullable | DÃ©faut | Description |
|---------|------|----------|--------|-------------|
| reseau_agence_id | uuid | NO | gen_random_uuid() | ğŸ”‘ Identifiant unique |
| organisation_id | uuid | NO | - | ğŸ”— Organisation de rattachement |
| reseau_id | uuid | NO | - | ğŸ”— RÃ©seau parent |
| reseau_agence_created_at | timestamp with time zone | NO | now() | Date de crÃ©ation |
| reseau_agence_created_by | uuid | YES | - | CrÃ©Ã© par (utilisateur) |
| reseau_agence_updated_at | timestamp with time zone | YES | now() | Date de modification |
| reseau_agence_updated_by | uuid | YES | - | ModifiÃ© par (utilisateur) |
| reseau_agence_nom | text | NO | - | Nom de l'agence |
| reseau_agence_identite_commerciale | text | YES | - | Nom commercial |
| reseau_agence_adresse | text | NO | - | Adresse complÃ¨te |
| reseau_agence_code_postal | text | NO | - | Code postal |
| reseau_agence_ville | text | NO | - | Ville |
| reseau_agence_telephone | text | NO | - | TÃ©lÃ©phone |
| reseau_agence_email | text | NO | - | Email principal |
| reseau_agence_siret | text | NO | - | NumÃ©ro SIRET |
| reseau_agence_inscription | timestamp with time zone | NO | now() | Date d'inscription |
| reseau_agence_date_debut_abonnement | timestamp with time zone | YES | - | DÃ©but abonnement |
| reseau_agence_date_resiliation_abonnement | timestamp with time zone | YES | - | Fin abonnement |
| reseau_agence_statut_abonnement | text | YES | - | Statut abonnement |
| reseau_agence_plan | text | YES | - | Plan souscrit |
| reseau_agence_statut_paiement | text | YES | - | Statut paiement |
| reseau_agence_abonnement_id | uuid | YES | - | ğŸ”— RÃ©fÃ©rence abonnement |
| reseau_agence_linkedin_connexion_id | uuid | YES | - | ğŸ”— Connexion LinkedIn |
| reseau_agence_facebook_connexion_id | uuid | YES | - | ğŸ”— Connexion Facebook |
| reseau_agence_instagram_connexion_id | uuid | YES | - | ğŸ”— Connexion Instagram |
| reseau_brevo_connexion_id | uuid | YES | - | ğŸ”— Connexion Brevo |
| reseau_zoho_connexion_id | uuid | YES | - | ğŸ”— Connexion Zoho |
| reseau_openai_connexion_id | uuid | YES | - | ğŸ”— Connexion OpenAI |
| client_type | text | NO | 'reseau_agence' | Type de client |
| client_id | uuid | NO | gen_random_uuid() | ID client gÃ©nÃ©rique |
| reseau_agence_logo | text | YES | - | Logo de l'agence |
| reseau_agence_ressources | ARRAY | YES | - | Ressources disponibles |
| reseau_agence_espace_client | boolean | NO | true | AccÃ¨s espace client |
| interdit_acces_admin_presenca | boolean | NO | false | Restriction admin PRESENCA |
| acces_presenca_agence | boolean | NO | true | AccÃ¨s plateforme PRESENCA |
| reseau_agence_statut | text | NO | 'actif' | Statut de l'agence |
| reseau_agence_audit_log | jsonb | YES | - | Journal d'audit |
| reseau_agence_ia_extensions | jsonb | YES | - | Extensions IA |

---

## ğŸ”§ DÃ‰FINITION SQL COMPLÃˆTE

```sql
/* SQL Definition generated from catalogs */
/* Owner: postgres | Tablespace: pg_default | RLS: enabled */

CREATE TABLE public.reseau_agence (
  reseau_agence_id uuid NOT NULL DEFAULT gen_random_uuid(),
  organisation_id uuid NOT NULL,
  reseau_id uuid NOT NULL,
  reseau_agence_created_at timestamp with time zone NOT NULL DEFAULT now(),
  reseau_agence_created_by uuid,
  reseau_agence_updated_at timestamp with time zone DEFAULT now(),
  reseau_agence_updated_by uuid,
  reseau_agence_nom text NOT NULL,
  reseau_agence_identite_commerciale text,
  reseau_agence_adresse text NOT NULL,
  reseau_agence_code_postal text NOT NULL,
  reseau_agence_ville text NOT NULL,
  reseau_agence_telephone text NOT NULL,
  reseau_agence_email text NOT NULL,
  reseau_agence_siret text NOT NULL,
  reseau_agence_inscription timestamp with time zone NOT NULL DEFAULT now(),
  reseau_agence_date_debut_abonnement timestamp with time zone,
  reseau_agence_date_resiliation_abonnement timestamp with time zone,
  reseau_agence_abonnement_id uuid,
  reseau_agence_plan text,
  reseau_agence_statut_abonnement text,
  reseau_agence_statut_paiement text,
  reseau_agence_statut text NOT NULL DEFAULT 'actif'::text,
  reseau_agence_logo text,
  reseau_agence_ressources text[],
  reseau_agence_espace_client boolean NOT NULL DEFAULT true,
  interdit_acces_admin_presenca boolean NOT NULL DEFAULT false,
  acces_presenca_agence boolean NOT NULL DEFAULT true,
  client_type text NOT NULL DEFAULT 'reseau_agence'::text,
  client_id uuid NOT NULL DEFAULT gen_random_uuid(),
  reseau_brevo_connexion_id uuid,
  reseau_agence_linkedin_connexion_id uuid,
  reseau_agence_facebook_connexion_id uuid,
  reseau_agence_instagram_connexion_id uuid,
  reseau_zoho_connexion_id uuid,
  reseau_openai_connexion_id uuid,
  reseau_agence_audit_log jsonb,
  reseau_agence_ia_extensions jsonb,
  CONSTRAINT reseau_agence_pkey PRIMARY KEY (reseau_agence_id)
);
```

---

## âš¡ TRIGGERS

#### 1. trigger_set_created_audit_fields_reseau_agence
- **Type:** BEFORE INSERT
- **Fonction:** set_created_audit_fields_reseau_agence()
- **Description:** DÃ©finit les champs d'audit Ã  la crÃ©ation

#### 2. trigger_update_audit_fields_reseau_agence
- **Type:** BEFORE UPDATE
- **Fonction:** update_audit_fields_reseau_agence()
- **Description:** Met Ã  jour les champs d'audit

---

## ğŸ”— RELATIONS ENTRE TABLES (FK)

### Relations sortantes
- **reseau_agence.organisation_id** â†’ organisations.organisation_id (implicite)
- **reseau_agence.reseau_id** â†’ reseau.reseau_id (implicite)
- **reseau_agence.reseau_agence_abonnement_id** â†’ abonnement_stripe.abonnement_id (implicite)

### Relations entrantes
- reseau_agence_responsable.reseau_agence_id â† reseau_agence.reseau_agence_id
- reseau_agence_collaborateur.reseau_agence_id â† reseau_agence.reseau_agence_id

---

## ğŸ”§ FONCTIONS LIÃ‰ES

### Fonctions utilisant cette table
- **set_created_audit_fields_reseau_agence()**: Trigger d'insertion
- **update_audit_fields_reseau_agence()**: Trigger de mise Ã  jour

---